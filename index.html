<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Home - KKR Studios</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Clerk SDK for Authentication -->
    <script>
        window.Clerk = {
            publishableKey: 'pk_test_YOUR_PUBLISHABLE_KEY_HERE' // Replace with your actual Clerk publishable key
        };
    </script>
    <script async crossorigin="anonymous" 
            data-clerk-publishable-key="pk_test_YOUR_PUBLISHABLE_KEY_HERE" 
            src="https://YOUR_FRONTEND_API.clerk.accounts.dev/npm/@clerk/clerk-js@latest/dist/clerk.browser.js">
    </script>
</head>
<body>
    <header class="site-header">
        <div style="display:flex; align-items:center; gap:10px;">
            <button id="menuBtn" class="btn" aria-label="Open menu"></button>
            <div class="brand">KKR STUDIOS</div>
        </div>
        <nav>
        </nav>
    </header>

    <main class="container">
        <div class="home-card" style="max-width:1120px; width:100%;">
            <div class="slider" id="heroSlider">
                <div class="slides">
                    <img src="hero.jpg" alt="Elegant venue lighting">
                    <img src="https://images.unsplash.com/photo-1511578314322-379afb476865?q=80&w=2000&auto=format&fit=crop" alt="Birthday celebration setup">
                    <img src="https://images.unsplash.com/photo-1511795409834-ef04bbd61622?q=80&w=2000&auto=format&fit=crop" alt="Anniversary romantic decor">
                    <img src="https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?q=80&w=2000&auto=format&fit=crop" alt="Cake and candles detail">
                    
                </div>
                <button class="nav prev" aria-label="Previous">‹</button>
                <button class="nav next" aria-label="Next">›</button>
                <div class="dots"></div>
            </div>
            <div style="display:flex; justify-content:center; margin: 14px 0 20px;">
                <a href="booking.html" class="btn primary">Book Now</a>
            </div>
            
            <!-- New clickable container -->
            <div class="feature-container">
                <div class="feature-text">
                    <h3>Home Birthday and Wedding Anniversary Decoration Services</h3>
                    <p>Transform your special moments with our beautiful decorations</p>
                </div>
                <div class="feature-image-slider">
                    <div class="slider-container">
                        <div class="slider-track">
                            <img src="hero.jpg" alt="Beautiful home decoration setup">
                            <img src="https://images.unsplash.com/photo-1511578314322-379afb476865?q=80&w=400&auto=format&fit=crop" alt="Birthday celebration setup">
                            <img src="https://images.unsplash.com/photo-1511795409834-ef04bbd61622?q=80&w=400&auto=format&fit=crop" alt="Anniversary romantic decor">
                            <img src="https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?q=80&w=400&auto=format&fit=crop" alt="Cake and candles detail">
                            <img src="https://images.unsplash.com/photo-1514517002830-8e8b0fd8141a?q=80&w=400&auto=format&fit=crop" alt="Warm lights ambiance">
                            <img src="https://images.unsplash.com/photo-1529627059279-9098883f05a0?q=80&w=400&auto=format&fit=crop" alt="Celebration moment">
                            <img src="https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?q=80&w=400&auto=format&fit=crop" alt="Decor details">
                            <img src="https://images.unsplash.com/photo-1464366400600-7168b8af9bc3?q=80&w=400&auto=format&fit=crop" alt="Wedding decoration">
                            <img src="https://images.unsplash.com/photo-1519167758481-83f142ee8e88?q=80&w=400&auto=format&fit=crop" alt="Party decorations">
                            <img src="https://images.unsplash.com/photo-1530103862676-de8c9debad1d?q=80&w=400&auto=format&fit=crop" alt="Elegant table setup">
                        </div>
                        <button class="slider-nav prev" aria-label="Previous image">‹</button>
                        <button class="slider-nav next" aria-label="Next image">›</button>
                        <div class="slider-dots"></div>
                    </div>
                </div>
                <div class="feature-actions">
                    <button class="btn primary" onclick="redirectToEcommerce()">Book Now</button>
                </div>
            </div>
            
            <div id="productGrid" class="product-grid"></div>
        </div>
    </main>

    <aside id="cartDrawer" class="cart-drawer">
        <div class="cart-header">
            <h2>Your Cart</h2>
            <button id="closeCart" class="btn">Close</button>
        </div>
        <div id="cartItems" class="cart-items"></div>
        <div class="cart-footer">
            <div class="cart-total-row">
                <span>Total</span>
                <strong id="cartTotal">$0.00</strong>
            </div>
            <div class="cart-actions">
                <button id="checkoutBtn" class="btn primary">Checkout</button>
                <button id="emptyCartBtn" class="btn">Empty Cart</button>
            </div>
        </div>
    </aside>

    <aside id="sideMenu" class="side-menu" aria-hidden="true">
        <div class="side-menu-header">
            <strong>Menu</strong>
            <button id="closeMenu" class="btn" aria-label="Close menu">Close</button>
        </div>
        <nav class="side-menu-list">
            <a href="#" id="menuProfile" class="side-link">Your Profile</a>
            <a href="#" id="menuCancel" class="side-link">Cancel Booking</a>
            <a href="#" id="menuHelp" class="side-link">Help</a>
            <a href="#" id="menuAbout" class="side-link">About</a>
            <button id="logoutBtn" class="btn" style="margin-top: 10px; width: 100%;">Logout</button>
        </nav>
    </aside>

    <footer class="site-footer">
        <div class="footer-inner">
            <div>
                <div class="footer-label">Contact</div>
                <div>+91 9019104086</div>
            </div>
            <div>
                <div class="footer-label">Email</div>
                <div>kirankumar68686@gmail.com</div>
            </div>
            <div>
                <div class="footer-label">Address</div>
                <div>KKR Studios,srinivaspura</div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Redirect function for Book Now button
        function redirectToEcommerce() {
            window.location.href = 'ecommerce.html';
        }
        
        // Hamburger menu functionality
        document.addEventListener('DOMContentLoaded', function() {
            setupHamburgerMenu();
            setupMenuOptions();
        });
        
        function setupHamburgerMenu() {
            const menuBtn = document.getElementById('menuBtn');
            const sideMenu = document.getElementById('sideMenu');
            const closeMenu = document.getElementById('closeMenu');
            
            if (menuBtn && sideMenu) {
                menuBtn.addEventListener('click', function() {
                    sideMenu.classList.add('open');
                    sideMenu.setAttribute('aria-hidden', 'false');
                });
            }
            
            if (closeMenu && sideMenu) {
                closeMenu.addEventListener('click', function() {
                    sideMenu.classList.remove('open');
                    sideMenu.setAttribute('aria-hidden', 'true');
                });
            }
            
            // Close menu when clicking outside
            if (sideMenu) {
                sideMenu.addEventListener('click', function(e) {
                    if (e.target === sideMenu) {
                        sideMenu.classList.remove('open');
                        sideMenu.setAttribute('aria-hidden', 'true');
                    }
                });
            }
        }
        
        function setupMenuOptions() {
            // Profile option
            const menuProfile = document.getElementById('menuProfile');
            if (menuProfile) {
                menuProfile.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeMenu();
                    window.location.href = 'profile.html';
                });
            }
            
            // Cancel Booking option
            const menuCancel = document.getElementById('menuCancel');
            if (menuCancel) {
                menuCancel.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeMenu();
                    showAlert('Cancel Booking', 'To cancel your booking, please contact us at +91 9019104086 or email kirankumar68686@gmail.com');
                });
            }
            
            // Help option
            const menuHelp = document.getElementById('menuHelp');
            if (menuHelp) {
                menuHelp.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeMenu();
                    showAlert('Help & Support', 'For any assistance, please contact us:\n\nPhone: +91 9019104086\nEmail: kirankumar68686@gmail.com\nAddress: KKR Studios, Srinivaspura');
                });
            }
            
            // About option
            const menuAbout = document.getElementById('menuAbout');
            if (menuAbout) {
                menuAbout.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeMenu();
                    showAlert('About KKR Studios', 'KKR Studios specializes in beautiful home decorations for birthdays, weddings, and special occasions. We provide premium event services with professional photography and venue setup.');
                });
            }
            
            // Logout option - will be handled by Clerk authentication script
            // The logout functionality is now managed by the Clerk authentication check below
        }
        
        function closeMenu() {
            const sideMenu = document.getElementById('sideMenu');
            if (sideMenu) {
                sideMenu.classList.remove('open');
                sideMenu.setAttribute('aria-hidden', 'true');
            }
        }
        
        function showAlert(title, message) {
            alert(`${title}\n\n${message}`);
        }
    </script>
    
    <!-- Clerk Authentication Check -->
    <script>
        // Check authentication status
        window.addEventListener('load', async () => {
            try {
                // Load Clerk
                await window.Clerk.load();
                
                // Check if user is authenticated
                if (!window.Clerk.user) {
                    console.log('User not authenticated, redirecting to login');
                    window.location.href = 'login.html';
                    return;
                }
                
                console.log('User authenticated:', window.Clerk.user);
                
                // Update logout functionality to use Clerk
                const logoutBtn = document.getElementById('logoutBtn');
                if (logoutBtn) {
                    // Remove any existing event listeners
                    logoutBtn.replaceWith(logoutBtn.cloneNode(true));
                    const newLogoutBtn = document.getElementById('logoutBtn');
                    
                    newLogoutBtn.addEventListener('click', async function(e) {
                        e.preventDefault();
                        closeMenu(); // Close the hamburger menu
                        
                        if (confirm('Are you sure you want to logout?')) {
                            try {
                                console.log('Attempting to logout with Clerk...');
                                await window.Clerk.signOut();
                                console.log('Logout successful, redirecting to login...');
                                window.location.href = 'login.html';
                            } catch (error) {
                                console.error('Logout failed:', error);
                                showAlert('Logout Error', 'Failed to logout. Please try again.');
                            }
                        }
                    });
                    
                    console.log('Clerk logout handler attached successfully');
                } else {
                    console.error('Logout button not found');
                }
                
            } catch (error) {
                console.error('Clerk authentication check failed:', error);
                // For development, you might want to allow access
                // In production, redirect to login
                console.log('Allowing access due to Clerk initialization error');
                
                // Add fallback logout functionality
                const logoutBtn = document.getElementById('logoutBtn');
                if (logoutBtn) {
                    logoutBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        closeMenu();
                        if (confirm('Are you sure you want to logout?')) {
                            // Clear any local storage and redirect
                            localStorage.clear();
                            sessionStorage.clear();
                            showAlert('Logged Out', 'You have been successfully logged out.');
                            setTimeout(() => {
                                window.location.href = 'login.html';
                            }, 1000);
                        }
                    });
                    console.log('Fallback logout handler attached');
                }
            }
        });
    </script>
</body>
</html>

